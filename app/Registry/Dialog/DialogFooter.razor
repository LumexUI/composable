@namespace LumexUI.Composable.Registry

@using TailwindMerge

<div class="@TwMerge.Merge( ClassName, Class )"
     data-slot="dialog-footer"
     @attributes="@AdditionalAttributes">
    @ChildContent

    @if( ShowCloseButton )
    {
        <Button type="button" Variant="@ButtonVariant.Outline">
            Close
        </Button>
    }
</div>

@code {
    [Parameter] public RenderFragment? ChildContent { get; set; }

    [Parameter] public bool ShowCloseButton { get; set; }

    [Parameter] public string? Class { get; set; }

    [Parameter( CaptureUnmatchedValues = true )]
    public IReadOnlyDictionary<string, object>? AdditionalAttributes { get; set; }

    [CascadingParameter] private Dialog Context { get; set; } = default!;

    [Inject] public TwMerge TwMerge { get; set; } = default!;

    protected override void OnInitialized()
    {
        if( Context is null )
        {
            throw new InvalidOperationException(
                $"<{nameof( DialogFooter )} /> must be used within a <{nameof( Dialog )} /> component."
            );
        }
    }

    /*
     * ----------------------------------------------------------------------------------
     * Styles
     * ----------------------------------------------------------------------------------
     */

    private string? ClassName => new ElementClass( "bg-muted/50 -mx-4 -mb-4 rounded-b-xl border-t p-4 flex flex-col-reverse gap-2 sm:flex-row sm:justify-end" );
}
